<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width">
<title>Delhi Monopoly</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body{font-family:Arial;background:#f4f4f4;padding:10px}
#status{background:#222;color:#fff;padding:6px;border-radius:6px;margin-bottom:8px;font-size:13px}
#board{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.tile{background:#fff;border-radius:8px;padding:6px;position:relative;min-height:90px}
</style>
</head>

<body>

<div id="status">Loadingâ€¦</div>

<h2>Delhi Monopoly</h2>

<input id="name" placeholder="Name">
<button onclick="join()">Join</button>

<div id="board"></div>

<script>
/* ðŸ”‘ IMPORTANT FIX */
const socket = io(window.location.origin);

let state = null;

document.getElementById("status").innerText = "Connecting to serverâ€¦";

socket.on("connect", () => {
  document.getElementById("status").innerText = "Connected. Waiting to join.";
});

socket.on("disconnect", () => {
  document.getElementById("status").innerText = "Disconnected";
});

function join(){
  alert("Join button clicked");
  const n = name.value.trim();
  if(!n){
    document.getElementById("status").innerText = "Enter name first";
    return;
  }
  socket.emit("join", n);
  document.getElementById("status").innerText = "Join sentâ€¦";
}

socket.on("state", s => {
  state = s;
  document.getElementById("status").innerText =
    "State received. Players: " + state.players.length;
  render();
});

function render(){
  const board = document.getElementById("board");
  board.innerHTML = "";

  if(!state || state.players.length === 0){
    board.innerHTML = "<p>No players yet</p>";
    return;
  }

  state.board.forEach(t=>{
    const d = document.createElement("div");
    d.className = "tile";
    d.innerText = t.name;
    board.appendChild(d);
  });
}
</script>

</body>
</html>
